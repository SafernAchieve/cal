{"ast":null,"code":"import { Frequency } from './types';\nimport { Weekday } from './weekday';\nimport dateutil from './dateutil';\nimport { Days } from './rrule';\nexport function parseString(rfcString) {\n  rfcString = rfcString.replace(/^\\s+|\\s+$/, '');\n  if (!rfcString.length) return null;\n  var options = {};\n  var dtstartWithZone = /^DTSTART;TZID=(.+?):([^;]+)$/.exec(rfcString);\n  if (dtstartWithZone) {\n    var _ = dtstartWithZone[0],\n      tzid = dtstartWithZone[1],\n      dtstart = dtstartWithZone[2];\n    options.tzid = tzid;\n    options.dtstart = dateutil.untilStringToDate(dtstart);\n    return options;\n  }\n  var attrs = rfcString.split(';');\n  for (var i = 0; i < attrs.length; i++) {\n    var attr = attrs[i].split('=');\n    var key = attr[0];\n    var value = attr[1];\n    switch (key) {\n      case 'FREQ':\n        options.freq = Frequency[value];\n        break;\n      case 'WKST':\n        options.wkst = Days[value];\n        break;\n      case 'COUNT':\n      case 'INTERVAL':\n      case 'BYSETPOS':\n      case 'BYMONTH':\n      case 'BYMONTHDAY':\n      case 'BYYEARDAY':\n      case 'BYWEEKNO':\n      case 'BYHOUR':\n      case 'BYMINUTE':\n      case 'BYSECOND':\n        var num = void 0;\n        if (value.indexOf(',') !== -1) {\n          var values = value.split(',');\n          num = values.map(function (val) {\n            if (/^[+-]?\\d+$/.test(val.toString())) {\n              return Number(val);\n            } else {\n              return val;\n            }\n          });\n        } else if (/^[+-]?\\d+$/.test(value)) {\n          num = Number(value);\n        } else {\n          num = value;\n        }\n        var optionKey = key.toLowerCase();\n        // @ts-ignore\n        options[optionKey] = num;\n        break;\n      case 'BYDAY':\n        // => byweekday\n        var n = void 0;\n        var wday = void 0;\n        var day = void 0;\n        var days = value.split(',');\n        options.byweekday = [];\n        for (var j = 0; j < days.length; j++) {\n          day = days[j];\n          if (day.length === 2) {\n            // MO, TU, ...\n            wday = Days[day]; // wday instanceof Weekday\n            options.byweekday.push(wday);\n          } else {\n            // -1MO, +3FR, 1SO, ...\n            var parts = day.match(/^([+-]?\\d)([A-Z]{2})$/);\n            n = Number(parts[1]);\n            var wdaypart = parts[2];\n            wday = Days[wdaypart].weekday;\n            options.byweekday.push(new Weekday(wday, n));\n          }\n        }\n        break;\n      case 'DTSTART':\n        options.dtstart = dateutil.untilStringToDate(value);\n        break;\n      case 'UNTIL':\n        options.until = dateutil.untilStringToDate(value);\n        break;\n      case 'BYEASTER':\n        options.byeaster = Number(value);\n        break;\n      default:\n        throw new Error(\"Unknown RRULE property '\" + key + \"'\");\n    }\n  }\n  return options;\n}","map":{"version":3,"names":["Frequency","Weekday","dateutil","Days","parseString","rfcString","replace","length","options","dtstartWithZone","exec","_","tzid","dtstart","untilStringToDate","attrs","split","i","attr","key","value","freq","wkst","num","indexOf","values","map","val","test","toString","Number","optionKey","toLowerCase","n","wday","day","days","byweekday","j","push","parts","match","wdaypart","weekday","until","byeaster","Error"],"sources":["../../src/parsestring.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}